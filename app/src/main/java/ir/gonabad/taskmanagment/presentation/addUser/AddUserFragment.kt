package ir.gonabad.taskmanagment.presentation.addUserimport android.os.Bundleimport android.util.Logimport android.view.LayoutInflaterimport android.view.Viewimport android.view.ViewGroupimport androidx.fragment.app.viewModelsimport androidx.navigation.fragment.findNavControllerimport dagger.hilt.android.AndroidEntryPointimport ir.ghadamyaar.aminsoft.stepcounter.helper.DataStateimport ir.gonabad.taskmanagment.Rimport ir.gonabad.taskmanagment.databinding.FragmentAddUserBindingimport ir.gonabad.taskmanagment.utils.BaseFragmentimport ir.gonabad.taskmanagment.utils.Constants@AndroidEntryPointclass AddUserFragment : BaseFragment() {    private val TAG = "AddUserFragment"    lateinit var binding : FragmentAddUserBinding    val viewModel : AddUserViewModel by viewModels()    override fun onCreateView(        inflater: LayoutInflater,        container: ViewGroup?,        savedInstanceState: Bundle?    ): View? {        binding = FragmentAddUserBinding.inflate(inflater , container , false)        return binding.root    }    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {        super.onViewCreated(view, savedInstanceState)        initViewModel()        initView()    }    private fun initView() {        binding.tbAddUser.setNavigationOnClickListener {            findNavController().popBackStack()        }        binding.btnAddUserApply.setOnClickListener {            val username = binding.etAddUserUsername.text.toString()            val password = binding.etAddUserPassword.text.toString()            val type = when {                binding.rbAddUserUser.isChecked -> Constants.TYPE_USER                binding.rbAddUserAdmin.isChecked -> Constants.TYPE_ADMIN                else -> Constants.TYPE_USER            }            when{                username.isNullOrEmpty() -> {                    binding.etAddUserUsername.error = getString(R.string.field_not_empty)                }                password.isNullOrEmpty() -> {                    binding.etAddUserPassword.error = getString(R.string.field_not_empty)                }                else -> {                    viewModel.register(username, password , type)                }            }        }    }    private fun initViewModel() {        viewModel.registerLiveData.observe(viewLifecycleOwner){            when(it){                is DataState.Loading -> {                    Log.i(TAG, "initViewModel: Loading")                    showLoading(true)                }                is DataState.Success -> {                    Log.i(TAG, "initViewModel: Success ${it.value}")                    showLoading(false)                    showToast(getString(R.string.add_user_success))                    findNavController().popBackStack()                }                is DataState.LocalError -> {                    Log.i(TAG, "initViewModel: LocalError ${it.message}")                    showLoading(false)                    showToast(getString(R.string.error_server))                }                is DataState.NetworkError -> {                    Log.i(TAG, "initViewModel: NetworkError ${it.networkError}")                    showLoading(false)                    showMessageErrorFromServer(it)                }            }        }    }    private fun showLoading(show : Boolean) {        binding.btnAddUserApply.visibility = if (show) View.GONE else View.VISIBLE        binding.pbAdduser.visibility = if (show) View.VISIBLE else View.GONE    }}
package ir.gonabad.taskmanagment.presentation.cviewsimport android.graphics.Typefaceimport android.os.Bundleimport android.view.LayoutInflaterimport android.view.Viewimport android.view.ViewGroupimport com.google.android.material.bottomsheet.BottomSheetDialogFragmentimport dagger.hilt.android.AndroidEntryPointimport ir.gonabad.taskmanagment.databinding.BtsDatePickerBindingimport ir.gonabad.taskmanagment.di.qualifier.MediumTypefaceimport saman.zamani.persiandate.PersianDateimport java.util.ArrayListimport javax.inject.Inject@AndroidEntryPointclass BottomSheetDatePicker(private val bottomSheetDatePickerListener: BottomSheetDatePickerListener) : BottomSheetDialogFragment() {    lateinit var binding : BtsDatePickerBinding    @Inject    @MediumTypeface    lateinit var typeFace : Typeface    private var selectMonth: Int = 6    private var selectDay: Int = 15    private var selectYear: Int = 1370    val monthList = listOf("فروردین" , "اردیبهشت" , "خرداد" , "تیر" , "مرداد" , "شهریور" , "مهر" , "آبان" , "آذر" , "دی" , "بهمن" , "اسفند")    override fun onCreateView(        inflater: LayoutInflater,        container: ViewGroup?,        savedInstanceState: Bundle?    ): View? {        binding = BtsDatePickerBinding.inflate(inflater , container , false)        return binding.root    }    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {        super.onViewCreated(view, savedInstanceState)        selectYear = PersianDate().shYear        selectMonth = PersianDate().shMonth - 1        selectDay = PersianDate().shDay        setText()        initView()    }    private fun initView() {        val yearList = arrayListOf<String>()        val dayList = arrayListOf<String>()        for (i in 1390..1420)            yearList.add(i.toString())        for (i in 1..31)            dayList.add(i.toString())        binding.npBtmDatepickerYear.apply {            minValue = 1390            maxValue = 1420            typeface = typeFace            setSelectedTypeface(typeFace)            displayedValues = yearList.toTypedArray()            setOnValueChangedListener { _, _, newVal ->                selectYear = newVal                setText()            }            value = selectYear        }        binding.npBtmDatepickerMonth.apply {            minValue = 0            maxValue = 11            typeface = typeFace            setSelectedTypeface(typeFace)            displayedValues = monthList.toTypedArray()            setOnValueChangedListener { _, _, newVal ->                selectMonth = newVal                setText()            }            value = selectMonth        }        binding.npBtmDatepickerDay.apply {            minValue = 1            maxValue = 31            typeface = typeFace            setSelectedTypeface(typeFace)            setOnValueChangedListener { _, _, newVal ->                selectDay = newVal                setText()            }            value = selectDay        }        binding.btnBtmDatepickerApply.setOnClickListener {            val time = PersianDate()            time.shYear = selectYear            time.shMonth = selectMonth            time.shDay = selectDay            bottomSheetDatePickerListener.confirmDate(                "$selectYear/${selectMonth + 1}/$selectDay" ,                time.time            )            dismiss()        }    }    private fun setText() {        binding.tvBtmDatePicker.text = "$selectYear/${selectMonth + 1}/$selectDay"    }    interface BottomSheetDatePickerListener{        fun confirmDate(textDate : String , timeDate : Long)    }}